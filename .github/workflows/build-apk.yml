name: ğŸµ ì„±ê²½ MP3 í”Œë ˆì´ì–´ APK ë¹Œë“œ

on:
  push:
    branches: [ main, master ]
  pull_request:
    branches: [ main, master ]
  workflow_dispatch:  # ìˆ˜ë™ ì‹¤í–‰ì„ ìœ„í•œ ì¤‘ìš”í•œ ì„¤ì •!
    inputs:
      build_type:
        description: 'ë¹Œë“œ íƒ€ì…ì„ ì„ íƒí•˜ì„¸ìš”'
        required: true
        default: 'debug'
        type: choice
        options:
          - debug
          - release

jobs:
  build-apk:
    runs-on: ubuntu-latest

    steps:
    - name: ğŸ“¥ ì†ŒìŠ¤ì½”ë“œ ì²´í¬ì•„ì›ƒ
      uses: actions/checkout@v4

    - name: ğŸ Python 3.8 ì„¤ì •
      uses: actions/setup-python@v4
      with:
        python-version: '3.8'

    - name: â˜• Java 8 ì„¤ì •
      uses: actions/setup-java@v3
      with:
        distribution: 'adopt'
        java-version: '8'

    - name: ğŸ“¦ ì‹œìŠ¤í…œ ì˜ì¡´ì„± ì„¤ì¹˜
      run: |
        sudo apt-get update
        sudo apt-get install -y git zip unzip openjdk-8-jdk python3-pip autoconf libtool pkg-config zlib1g-dev libncurses5-dev libncursesw5-dev libtinfo5 cmake libffi-dev libssl-dev

    - name: ğŸ”§ Python ì˜ì¡´ì„± ì„¤ì¹˜
      run: |
        python -m pip install --upgrade pip
        pip install buildozer cython kivy[base] requests

    - name: ğŸ“± Buildozer ì´ˆê¸°í™” ë° APK ë¹Œë“œ
      run: |
        # buildozer.spec íŒŒì¼ ì‚¬ìš©
        buildozer android ${{ github.event.inputs.build_type || 'debug' }}

    - name: ğŸ“‚ ë¹Œë“œ ê²°ê³¼ í™•ì¸
      run: |
        ls -la bin/

    - name: ğŸš€ APK íŒŒì¼ ì—…ë¡œë“œ
      uses: actions/upload-artifact@v4
      with:
        name: bible-mp3-player-${{ github.event.inputs.build_type || 'debug' }}-apk
        path: bin/*.apk

    - name: âœ… ë¹Œë“œ ì™„ë£Œ ì•Œë¦¼
      run: |
        echo "ğŸ‰ APK ë¹Œë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!"
        echo "ğŸ“± APK íŒŒì¼ì„ Artifactsì—ì„œ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤."